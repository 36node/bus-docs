# ADR 1: 使用bus-core-sdk进行服务间通讯获取车辆档案

Date: 2019-06-26

## 状态

废弃

## 背景

按最初的计划，所有微服务使用消息异步通知的方式进行通讯。
在bus-op等服务中，需要根据车辆信息搜索报警信息，这就要求bus-op要用某种方式获取bus-core中的车辆档案。

第一种方式是使用事件发布与订阅模式，bus-core的车辆档案有更新时，发布相关事件，bus-op订阅事件，在bus-op内部建立车辆档案的数据。

第二种方式是使用bus-core-sdk同步请求，bus-op创建报警信息时，通过bus-core-sdk获取车辆信息，存入报警信息数据中。

第三种方式是将车辆信息加入原始的TBOX数据后分发给给个微服务，bus-op消费含有车辆信息的TBOX数据。

## 决定

决定是用第二种方案，bus-op创建报警信息时，通过bus-core-sdk获取车辆信息，存入报警信息数据中。

## 后果

除了消息异步通知外，服务间会有直接的HTTP请求。
bus-op不需要完整同步一份车辆档案。

## 后续

实际实现中使用了第三种方式，bus-op不再需要直接调用bus-core。