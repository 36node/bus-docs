# ADR 3: 单元测试使用In Memory数据库进行Mock

Date: 2019-06-26

## 状态

生效中

## 背景

在model层的测试中，依赖一些数据库操作。
自己写mock非常复杂，几乎不可维护。

一种方案是使用一个真实的数据库，另一种是使用内存式嵌入式数据库。
两种方案在不同场景下各有优缺点。

## 决定

使用In Memory数据库作为Mock，测试model层。

## 后果

简化model层的测试编写。
model层测试不依赖外部数据库。
In Memory数据库和真实数据库可能有少量不兼容的情况，测试过的模块在真实数据库下的行为存在少量风险。

## 其他

API测试中使用真实数据库。
